# Xiaohongshu Favorites: Research + Feasibility Notes

Goal for this skill:
- List saved/collected notes from your XiaoHongShu account (via web UI)
- List saved boards (收藏专辑/收藏夹) and list notes inside a board
- Fetch note details (title/desc) for summarization

## GitHub References (avoid reinventing the wheel)

High-signal references for web behaviors, fields, and anti-bot constraints:
- https://github.com/JoeanAmier/XHS-Downloader (widely used; shows practical extraction patterns)
- https://github.com/lixi5338619/lxSpider (multi-site crawler patterns, includes XHS)
- https://github.com/Tangerineeew/Selenium-basedXiaohongshuCrawler (Selenium fallback approach)

## Approach Used By This Skill

XHS web endpoints often rely on request signatures/headers generated by site JS.
Instead of re-implementing the signing algorithm, this skill uses Playwright:
- Load pages with your real browser cookies (CookieCloud-supported)
- Extract structured data from `globalThis.__INITIAL_STATE__` (hydrated JSON state)
- Minimize DOM parsing (read JS state + scroll to load more)

Hydrated state paths currently used (best-effort; may change):
- Saved notes list: `__INITIAL_STATE__.user.notes._rawValue[1]`
- Saved boards list: `__INITIAL_STATE__.board.userBoardList._rawValue`
- Board feed items: `__INITIAL_STATE__.board.boardFeedsMap._rawValue[boardId].notes`
  - Pagination fields: `cursor`, `hasMore`

## Known Risks / Fallback Plan

- Headless detection / captcha: run with `--no-headless` to debug and complete any challenges.
- UI/state shape changes: if `__INITIAL_STATE__` paths change, use Playwright network
  interception to locate the JSON XHR responses that contain the same data and parse those.

## Manual Test Checklist (requires valid cookies)

1) Detect profile id:
- Run `xhs_whoami.py` and confirm it prints a `/user/profile/<id>` id.

2) List saved notes:
- Run `xhs_saved_notes.py --max 20` and confirm it prints note ids + URLs.

3) List saved boards (收藏专辑/收藏夹):
- Run `xhs_boards.py --max 20` and confirm it prints board ids + names.

4) List items inside a board:
- Pick a board id from (3) and run `xhs_board_items.py --board-id <boardId> --max 20`.
- Confirm each item includes `note_id` and `xsec_token` (useful for note detail fetch).

5) Note details:
- Pick a note URL from (2) and run `xhs_note_detail.py --url <url>`.
- Confirm it prints a title + description (or at least extracts a `note_id` + raw JSON).
